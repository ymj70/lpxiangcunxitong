<div class="framePage">
    <div class="framePage-title">
        <a href="javascript:;">人员登记</a>
        <i>></i>
        <a href="javascript:;" class="cur-a">未参保人员登记</a>
    </div>
    <div class="framePage-body layui-form">
        <div class="framePage-scroll">
            <div class="ovy-a">
                <div class="content">
                    <h2>登记人员信息</h2>
                    <div class="content_form">
                        <div class="form_box form_bt">
                            <h3>人员基本信息<span>（必填）</span></h3>
                            <div class="inputBox">
                                <div class="form">
                                    <div class="form-cell">
                                        <label class="label">姓&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp名</label>
                                        <input type="text" value="{$peopleInfo['realName']|default=''}" id="realName" disabled>
                                    </div>
                                    <div class="form-cell">
                                        <label class="label">身份证号</label>
                                        <input type="text" value="{$peopleInfo['idCard']|default=''}" id="idCard" disabled>
                                        <span></span>
                                    </div>
                                    <div class="form-cell">
                                        <label class="label_h">戶籍所在地</label>
                                        <div>
                                            <input type="text" name="tel" class="layui-input" id="idCardAddress" placeholder="请输入戶籍所在地" value="{$peopleInfo['idCardAddress']|default=''}">
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>联系电话</label>
                                        <div>
                                            <input type="text" name="tel" class="layui-input" id="telephone" placeholder="请输入当前用户有效联系电话">
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>婚姻状况</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="marriage">
                                                <option value=""></option>
                                                <option value="已婚">已婚</option>
                                                <option value="未婚">未婚</option>
                                                <option value="离异">离异</option>
                                                <option value="丧偶">丧偶</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form form_l">
                                    <div class="form-cell">
                                        <label>出生日期</label>
                                        <div>
                                            <input placeholder="选择日期" type="text" class="layui-input float-l" id="month" value="{$peopleInfo['birthday']|default=''}">
                                            <img src="__PUBLIC__/image/rydj_rq_03.png" alt="">
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>民&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp族</label>
                                        <div>
                                            <select name="stu3" lay-verify="required" id="mz">
                                                <option value="{$peopleInfo['national']|default=''}">{$peopleInfo['national']|default=''}</option>
                                            </select>
                                        </div>
                                        <label>性&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp别</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="sex">
                                                <option value="{$peopleInfo['sex']|default=''}">{$peopleInfo['sex']|default=''}</option>
                                                <option value="男">男</option>
                                                <option value="女">女</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>家庭住址</label>
                                        <div>
                                            <input type="text" name="tel" class="layui-input" id="familyAddress" placeholder="请输入居住地址">
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label class="label_t">人员类型</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="peopleType">
                                                <option value="">无</option>
                                                <option value="党员">党员</option>
                                                <option value="群众">群众</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>户籍性质</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="householdRegister">
                                                <option value="">请选择</option>
                                                <option value="农业户口">农业户口</option>
                                                <option value="城镇户口">城镇户口</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form_box form_bt">
                            <h3>与户主关系<span>（必填）</span></h3>
                            <div class="inputBox">
                                <div class="form">
                                    <div class="form-cell">
                                        <label>户主姓名</label>
                                        <div>
                                            <input placeholder="请填写户主姓名" type="text" class="layui-input float-l" id="householdHeadName">
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>与户主关系</label>
                                        <div>
                                            <input type="text" name="text" class="layui-input" id="householdHeadRelation" placeholder="请输入与户主关系">
                                        </div>
                                    </div>
                                </div>
                                <div class="form form_l">
                                    <div class="form-cell">
                                        <label class="label_h">户主身份证号</label>
                                        <div>
                                            <input type="text" name="text" class="layui-input" id="householdHeadIdCard" placeholder="请输入户主身份证号">
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label class="label_h">户主联系电话</label>
                                        <div>
                                            <input type="text" name="tel" class="layui-input" id="householdHeadPhone" placeholder="请输入户主联系电话">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form_box mb">
                            <h3>其他信息<span>（选填）</span></h3>
                            <div class="inputBox">
                                <div class="form">
                                    <div class="form-cell">
                                        <label>是否县外参保</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="whetherOutsideAttendIns">
                                                <option value="">请选择</option>
                                                <option value="是">是</option>
                                                <option value="否">否</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label>未参保原因</label>
                                        <div>
                                            <input type="text" name="text" class="layui-input" id="notAttendInsReason" placeholder="请输入未参保原因">
                                        </div>
                                    </div>
                                </div>
                                <div class="form form_l">
                                    <div class="form-cell">
                                        <label class="label_h">是否就业</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="whetherEmployment">
                                                <option value="">请选择</option>
                                                <option value="是">是</option>
                                                <option value="否">否</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-cell">
                                        <label class="label_h">流动人员</label>
                                        <div>
                                            <select name="stu" name="addr" lay-verify="required" id="flowPeople">
                                                <option value="">请选择</option>
                                                <option value="是">是</option>
                                                <option value="否">否</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="formBtn">
                    <button id="next" class="layui-btn bgc-blued" onclick="nextSteup()">下一步</button>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</div>
</body>
<include file="Public:footer" />
<script>
function nextSteup() {
    if (check() == false) {
        return false;
    } else {
        $.ajax({
            type: "post",
            url: "{:U('/Home/NotAttendIns/getPeopleInfo')}",
            data: {
                realName: $("#realName").val(), //姓名
                idCard: $("#idCard").val(), //身份证号
                sex: $("#sex").val(), //性别
                national: $("#mz").val(), //民族
                birthday: $("#month").val(), //出生日期
                idCardAddress: $("#idCardAddress").val(), //户籍所在地
                familyAddress: $("#familyAddress").val(), //家庭住址
                telephone: $("#telephone").val(), //联系电话
                peopleType: $("#peopleType").val(), //人员类型
                marriage: $("#marriage").val(), //婚否
                householdRegister: $("#householdRegister").val(), //户口性质
                householdHeadName: $("#householdHeadName").val(), //户主姓名
                householdHeadIdCard: $("#householdHeadIdCard").val(), //户主身份证号
                householdHeadPhone: $("#householdHeadPhone").val(), //户主电话号码
                householdHeadRelation: $("#householdHeadRelation").val(), //与户主关系
                whetherOutsideAttendIns: $("#whetherOutsideAttendIns").val(), //是否县外参保
                whetherEmployment: $("#whetherEmployment").val(), //是否就业
                flowPeople: $("#flowPeople").val(), //流动人员
                notAttendInsReason: $("#notAttendInsReason").val(), //未参保原因
            },
            dataType: "json",
            beforeSend: function() {},
            success: function(ret) {
                if (ret.code == 1) {
                    if (ret.url == "") {
                        layer.msg("跳转路径接受失败");
                    } else {
                        window.location.href = ret.url;
                    }
                    $("#listHtml").html(ret.data)
                } else {
                    if (ret.message == '') {
                        layer.msg('请输入正确的身份证号！');
                    } else {
                        layer.msg(ret.message);

                    }
                }
            },
        });
    }


}
//校验
function check() {

    var phoneStr = /^[1][3,4,5,7,8][0-9]{9}$/;
    var pattern = /^([1-9]{1})(\d{14}|\d{18})$/;
    var idC =  /^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[A-Z])$/;
    var idCard=$("#idCard").val();
    var mz=$("#mz").val();
    var month = $('#month').val();
    var phone=$("#telephone").val();
    var sex = $('#sex').val();
    var familyAddress = $("#familyAddress").val();
    var telephone = $('#phone').val();
    var peopleType = $("#peopleType").val();
    var marriage = $("#marriage").val();
    var householdRegister = $("#householdRegister").val();
    var householdHeadName = $("#householdHeadName").val();
    var householdHeadIdCard = $("#householdHeadIdCard").val();
    var householdHeadRelation = $("#householdHeadRelation").val();
    var householdHeadPhone = $("#householdHeadPhone").val();
    // alert(idC.test(idCard));
    if (realName == "") {
        layer.msg("请输入姓名");
        return false;
    } else if (month == "") {
        layer.msg("请选择出生日期");
        return false;
    } else if (idCard == "") {
        layer.msg("请输入身份证号");
        return false;
    } else if (idC.test(idCard)==false) {
        layer.msg('身份证号格式不正确')
        return false;
    } else if (mz == "") {
        layer.msg("请选择民族");
        return false;
    } else if (sex == "") {
        layer.msg("请选择性别");
        return false;
    } else if (idCardAddress == "") {
        layer.msg("请输入户籍所在地");
        return false;
    } else if (familyAddress == "") {
        layer.msg("请输入家庭住址");
        return false;
    } else if (phone == "") {
        layer.msg("请输入联系电话");
        return false;
    } else if (!phoneStr.test(phone)) {
        layer.msg('联系电话格式不正确')
        return false;
    } else if (peopleType == "") {
        layer.msg("请选择人员类型");
        return false;
    } else if (marriage == "") {
        layer.msg("请选择婚姻状况");
        return false;
    } else if (householdRegister == "") {
        layer.msg("请选择户籍性质");
        return false;
    } else if (householdHeadName == "") {
        layer.msg("请填写户主姓名");
        return false;
    } else if (householdHeadIdCard == "") {
        layer.msg("请填写户主身份证号");
        return false;
    } else if (!idC.test(householdHeadIdCard)) {
        layer.msg('户主身份证号格式不正确')
        return false;
    } else if (householdHeadRelation == "") {
        layer.msg("请填写与户主关系");
        return false;
    } else if (householdHeadPhone == "") {
        layer.msg("请填写户主联系电话");
        return false;
    } else if (!phoneStr.test(householdHeadPhone)) {
        layer.msg('户主联系电话格式不正确')
        return false;
    } else {
        return true;
    }
}
$(document).ready(function() {
    // 日期
    var laydate = layui.laydate;
    laydate.render({
        elem: '#month' //指定元素
        // ,range: true
    })
    laydate.render({
        elem: '#start' //指定元素
            ,
        range: '--'
    })
    laydate.render({
        elem: '#start1' //指定元素
            ,
        range: '--'
    })
    laydate.render({
        elem: '#start2' //指定元素
            ,
        range: '--'
    })
    laydate.render({
        elem: '#start3' //指定元素
            ,
        range: '--'
    })
    // 民族
    var nations = ["汉族", "蒙古族", "回族", "藏族", "维吾尔族", "苗族", "彝族", "壮族", "布依族", "朝鲜族", "满族", "侗族", "瑶族", "白族", "土家族",
        "哈尼族", "哈萨克族", "傣族", "黎族", "傈僳族", "佤族", "畲族", "高山族", "拉祜族", "水族", "东乡族", "纳西族", "景颇族", "柯尔克孜族",
        "土族", "达斡尔族", "仫佬族", "羌族", "布朗族", "撒拉族", "毛南族", "仡佬族", "锡伯族", "阿昌族", "普米族", "塔吉克族", "怒族", "乌孜别克族",
        "俄罗斯族", "鄂温克族", "德昂族", "保安族", "裕固族", "京族", "塔塔尔族", "独龙族", "鄂伦春族", "赫哲族", "门巴族", "珞巴族", "基诺族"
    ];
    var nation = $("#mz");
    for (var i = 0; i < nations.length; i++) {
        var a = nations[i];
        nation.append("<option value='" + a + "'>" + a + "</option>");
    }
    layuiform()

})
</script>

</html>